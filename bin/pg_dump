#!/bin/bash

# Wrapper script for pg_dump that filters out PostgreSQL 17's \restrict and \unrestrict commands
# which are not supported by sqlc

# Use the real pg_dump from PostgreSQL 17
REAL_PG_DUMP="/opt/homebrew/opt/postgresql@17/bin/pg_dump"

# Run the real pg_dump with all arguments and filter the output
"$REAL_PG_DUMP" "$@" | grep -v '^\\restrict' | grep -v '^\\unrestrict'
